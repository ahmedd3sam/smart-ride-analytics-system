[2025-11-27T10:06:19.617+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: taxi_streaming_pipeline.run_flink_job manual__2025-11-27T10:06:15.645597+00:00 [queued]>
[2025-11-27T10:06:19.626+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: taxi_streaming_pipeline.run_flink_job manual__2025-11-27T10:06:15.645597+00:00 [queued]>
[2025-11-27T10:06:19.626+0000] {taskinstance.py:1359} INFO - Starting attempt 1 of 2
[2025-11-27T10:06:19.642+0000] {taskinstance.py:1380} INFO - Executing <Task(BashOperator): run_flink_job> on 2025-11-27 10:06:15.645597+00:00
[2025-11-27T10:06:19.651+0000] {standard_task_runner.py:57} INFO - Started process 50 to run task
[2025-11-27T10:06:19.653+0000] {standard_task_runner.py:84} INFO - Running: ['airflow', 'tasks', 'run', 'taxi_streaming_pipeline', 'run_flink_job', 'manual__2025-11-27T10:06:15.645597+00:00', '--job-id', '139', '--raw', '--subdir', 'DAGS_FOLDER/taxi_pipeline_dag.py', '--cfg-path', '/tmp/tmp9k9r12py']
[2025-11-27T10:06:19.655+0000] {standard_task_runner.py:85} INFO - Job 139: Subtask run_flink_job
[2025-11-27T10:06:20.162+0000] {task_command.py:415} INFO - Running <TaskInstance: taxi_streaming_pipeline.run_flink_job manual__2025-11-27T10:06:15.645597+00:00 [running]> on host 485e0d4eae03
[2025-11-27T10:06:20.288+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Menna' AIRFLOW_CTX_DAG_ID='taxi_streaming_pipeline' AIRFLOW_CTX_TASK_ID='run_flink_job' AIRFLOW_CTX_EXECUTION_DATE='2025-11-27T10:06:15.645597+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-11-27T10:06:15.645597+00:00'
[2025-11-27T10:06:20.290+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-11-27T10:06:20.291+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'docker exec flink-jobmanager flink run -py /opt/flink/jobs/kafka_consumer_ui.py']
[2025-11-27T10:06:20.309+0000] {subprocess.py:86} INFO - Output:
[2025-11-27T10:06:30.166+0000] {subprocess.py:93} INFO - WARNING: An illegal reflective access operation has occurred
[2025-11-27T10:06:30.166+0000] {subprocess.py:93} INFO - WARNING: Illegal reflective access by org.apache.flink.api.java.ClosureCleaner (file:/opt/flink/lib/flink-dist-1.17.2.jar) to field java.lang.String.value
[2025-11-27T10:06:30.166+0000] {subprocess.py:93} INFO - WARNING: Please consider reporting this to the maintainers of org.apache.flink.api.java.ClosureCleaner
[2025-11-27T10:06:30.166+0000] {subprocess.py:93} INFO - WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
[2025-11-27T10:06:30.166+0000] {subprocess.py:93} INFO - WARNING: All illegal access operations will be denied in a future release
[2025-11-27T10:06:32.210+0000] {subprocess.py:93} INFO - Job has been submitted with JobID 104aa98f739b26b275816eb573c30aeb
[2025-11-27T10:06:32.256+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-11-27T10:06:32.257+0000] {subprocess.py:93} INFO -   File "/opt/flink/jobs/kafka_consumer_ui.py", line 286, in <module>
[2025-11-27T10:06:32.257+0000] {subprocess.py:93} INFO -     env.execute("Flink Kafka Taxi Dashboard Job")
[2025-11-27T10:06:32.257+0000] {subprocess.py:93} INFO -   File "/opt/flink/opt/python/pyflink.zip/pyflink/datastream/stream_execution_environment.py", line 763, in execute
[2025-11-27T10:06:32.257+0000] {subprocess.py:93} INFO -   File "/opt/flink/opt/python/pyflink.zip/pyflink/datastream/stream_execution_environment.py", line 1012, in _generate_stream_graph
[2025-11-27T10:06:32.258+0000] {subprocess.py:93} INFO -   File "/opt/flink/opt/python/py4j-0.10.9.7-src.zip/py4j/java_gateway.py", line 1322, in __call__
[2025-11-27T10:06:32.258+0000] {subprocess.py:93} INFO -   File "/opt/flink/opt/python/pyflink.zip/pyflink/util/exceptions.py", line 146, in deco
[2025-11-27T10:06:32.258+0000] {subprocess.py:93} INFO -   File "/opt/flink/opt/python/py4j-0.10.9.7-src.zip/py4j/protocol.py", line 326, in get_return_value
[2025-11-27T10:06:32.259+0000] {subprocess.py:93} INFO - py4j.protocol.Py4JJavaError: An error occurred while calling o8.getStreamGraph.
[2025-11-27T10:06:32.259+0000] {subprocess.py:93} INFO - : java.lang.IllegalStateException: No operators defined in streaming topology. Cannot execute.
[2025-11-27T10:06:32.260+0000] {subprocess.py:93} INFO - 	at org.apache.flink.streaming.api.environment.StreamExecutionEnvironment.getStreamGraphGenerator(StreamExecutionEnvironment.java:2290)
[2025-11-27T10:06:32.260+0000] {subprocess.py:93} INFO - 	at org.apache.flink.streaming.api.environment.StreamExecutionEnvironment.getStreamGraph(StreamExecutionEnvironment.java:2257)
[2025-11-27T10:06:32.260+0000] {subprocess.py:93} INFO - 	at org.apache.flink.streaming.api.environment.StreamExecutionEnvironment.getStreamGraph(StreamExecutionEnvironment.java:2248)
[2025-11-27T10:06:32.260+0000] {subprocess.py:93} INFO - 	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[2025-11-27T10:06:32.260+0000] {subprocess.py:93} INFO - 	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
[2025-11-27T10:06:32.260+0000] {subprocess.py:93} INFO - 	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
[2025-11-27T10:06:32.260+0000] {subprocess.py:93} INFO - 	at java.base/java.lang.reflect.Method.invoke(Unknown Source)
[2025-11-27T10:06:32.260+0000] {subprocess.py:93} INFO - 	at org.apache.flink.api.python.shaded.py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
[2025-11-27T10:06:32.260+0000] {subprocess.py:93} INFO - 	at org.apache.flink.api.python.shaded.py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
[2025-11-27T10:06:32.261+0000] {subprocess.py:93} INFO - 	at org.apache.flink.api.python.shaded.py4j.Gateway.invoke(Gateway.java:282)
[2025-11-27T10:06:32.261+0000] {subprocess.py:93} INFO - 	at org.apache.flink.api.python.shaded.py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
[2025-11-27T10:06:32.261+0000] {subprocess.py:93} INFO - 	at org.apache.flink.api.python.shaded.py4j.commands.CallCommand.execute(CallCommand.java:79)
[2025-11-27T10:06:32.261+0000] {subprocess.py:93} INFO - 	at org.apache.flink.api.python.shaded.py4j.GatewayConnection.run(GatewayConnection.java:238)
[2025-11-27T10:06:32.261+0000] {subprocess.py:93} INFO - 	at java.base/java.lang.Thread.run(Unknown Source)
[2025-11-27T10:06:32.261+0000] {subprocess.py:93} INFO - 
[2025-11-27T10:06:32.317+0000] {subprocess.py:93} INFO - org.apache.flink.client.program.ProgramAbortException: java.lang.RuntimeException: Python process exits with code: 1
[2025-11-27T10:06:32.317+0000] {subprocess.py:93} INFO - 	at org.apache.flink.client.python.PythonDriver.main(PythonDriver.java:140)
[2025-11-27T10:06:32.318+0000] {subprocess.py:93} INFO - 	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[2025-11-27T10:06:32.318+0000] {subprocess.py:93} INFO - 	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
[2025-11-27T10:06:32.318+0000] {subprocess.py:93} INFO - 	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
[2025-11-27T10:06:32.319+0000] {subprocess.py:93} INFO - 	at java.base/java.lang.reflect.Method.invoke(Unknown Source)
[2025-11-27T10:06:32.319+0000] {subprocess.py:93} INFO - 	at org.apache.flink.client.program.PackagedProgram.callMainMethod(PackagedProgram.java:355)
[2025-11-27T10:06:32.319+0000] {subprocess.py:93} INFO - 	at org.apache.flink.client.program.PackagedProgram.invokeInteractiveModeForExecution(PackagedProgram.java:222)
[2025-11-27T10:06:32.319+0000] {subprocess.py:93} INFO - 	at org.apache.flink.client.ClientUtils.executeProgram(ClientUtils.java:105)
[2025-11-27T10:06:32.319+0000] {subprocess.py:93} INFO - 	at org.apache.flink.client.cli.CliFrontend.executeProgram(CliFrontend.java:851)
[2025-11-27T10:06:32.319+0000] {subprocess.py:93} INFO - 	at org.apache.flink.client.cli.CliFrontend.run(CliFrontend.java:245)
[2025-11-27T10:06:32.319+0000] {subprocess.py:93} INFO - 	at org.apache.flink.client.cli.CliFrontend.parseAndRun(CliFrontend.java:1095)
[2025-11-27T10:06:32.320+0000] {subprocess.py:93} INFO - 	at org.apache.flink.client.cli.CliFrontend.lambda$mainInternal$9(CliFrontend.java:1189)
[2025-11-27T10:06:32.320+0000] {subprocess.py:93} INFO - 	at org.apache.flink.runtime.security.contexts.NoOpSecurityContext.runSecured(NoOpSecurityContext.java:28)
[2025-11-27T10:06:32.320+0000] {subprocess.py:93} INFO - 	at org.apache.flink.client.cli.CliFrontend.mainInternal(CliFrontend.java:1189)
[2025-11-27T10:06:32.320+0000] {subprocess.py:93} INFO - 	at org.apache.flink.client.cli.CliFrontend.main(CliFrontend.java:1157)
[2025-11-27T10:06:32.320+0000] {subprocess.py:93} INFO - Caused by: java.lang.RuntimeException: Python process exits with code: 1
[2025-11-27T10:06:32.320+0000] {subprocess.py:93} INFO - 	at org.apache.flink.client.python.PythonDriver.main(PythonDriver.java:130)
[2025-11-27T10:06:32.321+0000] {subprocess.py:93} INFO - 	... 14 more
[2025-11-27T10:06:32.411+0000] {subprocess.py:97} INFO - Command exited with return code 31
[2025-11-27T10:06:32.435+0000] {taskinstance.py:1935} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 31.
[2025-11-27T10:06:32.442+0000] {taskinstance.py:1398} INFO - Marking task as UP_FOR_RETRY. dag_id=taxi_streaming_pipeline, task_id=run_flink_job, execution_date=20251127T100615, start_date=20251127T100619, end_date=20251127T100632
[2025-11-27T10:06:32.468+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 139 for task run_flink_job (Bash command failed. The command returned a non-zero exit code 31.; 50)
[2025-11-27T10:06:32.493+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2025-11-27T10:06:32.516+0000] {taskinstance.py:2776} INFO - 0 downstream tasks scheduled from follow-on schedule check
